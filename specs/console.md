# Спецификация: Консоль приложения (IRB)

## Обзор

Требуется реализовать интерактивную консоль для приложения, аналогичную Rails console, которая позволит разработчикам взаимодействовать с компонентами бота в реальном времени.

## Требования

### Функциональность
1. **Запуск консоли**: Команда для запуска интерактивной сессии
2. **Доступ к компонентам**: Возможность взаимодействия с основными объектами приложения
3. **Автозагрузка**: Автоматическая загрузка всех необходимых файлов и зависимостей
4. **История команд**: Сохранение истории введенных команд
5. **Подсветка синтаксиса**: Улучшенный пользовательский опыт

### Доступные объекты в консоли
- `bot` - экземпляр TelegramBotHandler
- `llm_client` - экземпляр LLMClient
- `conversation_manager` - экземпляр ConversationManager
- `rate_limiter` - экземпляр RateLimiter
- `config` - AppConfig
- `logger` - логгер приложения

### Команды
- `console` или `c` - запуск консоли
- `console --sandbox` - запуск в песочнице (без отправки реальных сообщений)
- `console --help` - показать справку

## Техническая реализация

### Файлы
- `bin/console` - исполняемый файл для запуска консоли
- `lib/console.rb` - основной класс консоли
- `lib/console/sandbox.rb` - режим песочницы
- `lib/console/helpers.rb` - вспомогательные методы

### Зависимости
- `irb` - стандартная библиотека Ruby
- `rake` - для интеграции с задачами

### Интеграция с AppConfig
- Консоль должна использовать конфигурацию приложения
- В sandbox режиме использовать тестовые/моковые значения

## Тестирование

### Юнит-тесты
- Проверка запуска консоли
- Проверка доступности объектов
- Проверка режима песочницы
- Проверка автозагрузки зависимостей

### Интеграционные тесты
- Проверка взаимодействия с реальными компонентами
- Проверка конфигурации окружения

## Примеры использования

```bash
# Запуск консоли
./bin/console

# В консоли:
irb(main):001> bot.class
=> TelegramBotHandler

irb(main):002> config.bot_token
=> "your_token_here"

irb(main):003> llm_client.chat("Hello")
=> "Response from LLM"
```

## Критерии приемки

1. ✅ Консоль запускается командой `./bin/console`
2. ✅ Все основные объекты доступны в консоли
3. ✅ Режим песочницы предотвращает реальные действия
4. ✅ История команд сохраняется между сессиями
5. ✅ Подсветка синтаксиса работает корректно
6. ✅ Консоль интегрирована с системой конфигурации
7. ✅ Есть соответствующие тесты
8. ✅ Документация по использованию в README.md

## Реализация

### Этап 1: Базовая консоль
- Создать исполняемый файл `bin/console`
- Реализовать базовый запуск IRB с загрузкой приложения

### Этап 2: Интеграция с компонентами
- Сделать доступными основные объекты приложения
- Настроить автозагрузку зависимостей

### Этап 3: Режим песочницы
- Реализовать sandbox режим
- Мокировать реальные API вызовы

### Этап 4: Улучшения
- Добавить подсветку синтаксиса
- Настроить историю команд
- Добавить вспомогательные методы

### Этап 5: Тестирование и документация
- Написать тесты
- Обновить документацию
- Проверить интеграцию